import{_ as Q,r as R,a as G,s as K,l as W,c as y,b as i,d as e,t as U,w as a,f as d,u as X,o as g,g as b,k,N as Z,z as ee,y as q,F as E,p as M,U as P,E as v}from"./index-BhSzniFR.js";import{r as T}from"./recipe-mvCqemeP.js";const le={class:"create-recipe-page"},te={class:"page-header"},ae=["src"],oe={class:"section-header"},se={class:"ingredients-list"},re={class:"section-header"},ie={class:"steps-list"},ne={class:"step-number"},de={class:"form-actions"},ue={__name:"CreateRecipe",setup(pe){const D=W(),A=X(),C=R(null),w=R(!1),_=R(!1),t=G({title:"",description:"",category:"",coverImage:"",cookingTime:30,servings:2,difficulty:"EASY",ingredients:[{name:"",amount:""}],steps:[{step:1,description:""}],tips:"",equipment:[]}),x={title:[{required:!0,message:"Please enter recipe title",trigger:"blur"},{min:3,max:100,message:"Title must be 3-100 characters",trigger:"blur"}],description:[{required:!0,message:"Please enter description",trigger:"blur"}],category:[{required:!0,message:"Please select category",trigger:"change"}],cookingTime:[{required:!0,message:"Please enter cooking time",trigger:"blur"}],servings:[{required:!0,message:"Please enter servings",trigger:"blur"}],difficulty:[{required:!0,message:"Please select difficulty",trigger:"change"}]},N=n=>({main:1,quick:2,soups:3,baking:4,desserts:5,vegetarian:6,meat:7})[n]||1,B=n=>{t.coverImage=URL.createObjectURL(n.raw)},F=()=>{t.ingredients.push({name:"",amount:""})},O=n=>{t.ingredients.length>1?t.ingredients.splice(n,1):v.warning("At least one ingredient is required")},$=()=>{t.steps.push({step:t.steps.length+1,description:""})},J=n=>{t.steps.length>1?(t.steps.splice(n,1),t.steps.forEach((l,u)=>{l.step=u+1})):v.warning("At least one step is required")},z=async()=>{v.success("Recipe saved as draft"),localStorage.setItem("recipeDraft",JSON.stringify(t))},L=async()=>{C.value&&await C.value.validate(async n=>{if(n){const l=t.ingredients.filter(s=>s.name&&s.amount);if(l.length===0){v.error("Please add at least one ingredient");return}const u=t.steps.filter(s=>s.description);if(u.length===0){v.error("Please add at least one cooking step");return}w.value=!0;try{const s={title:t.title,description:t.description,categoryId:N(t.category),userId:2,ingredients:JSON.stringify(l),steps:JSON.stringify(u.map((c,p)=>({step:p+1,description:c.description}))),cookingTime:t.cookingTime,difficulty:t.difficulty,servings:t.servings,tips:t.tips||"",coverImage:t.coverImage||"",status:1};_.value?await T.updateRecipe(D.params.id,s):await T.createRecipe(s),v.success(_.value?"Recipe updated successfully!":"Recipe published successfully!"),localStorage.removeItem("recipeDraft"),A.push("/recipes")}catch(s){console.error("Failed to save recipe:",s),v.error("Failed to save recipe. Please try again.")}finally{w.value=!1}}})};return K(()=>{D.params.id&&(_.value=!0);const n=localStorage.getItem("recipeDraft");n&&!_.value&&Object.assign(t,JSON.parse(n))}),(n,l)=>{const u=d("el-icon"),s=d("el-button"),c=d("el-input"),p=d("el-form-item"),r=d("el-option"),I=d("el-select"),j=d("el-upload"),V=d("el-card"),h=d("el-input-number"),S=d("el-col"),H=d("el-row"),Y=d("el-form");return g(),y("div",le,[i("div",te,[i("h1",null,U(_.value?"Edit Recipe":"Create New Recipe"),1),e(s,{onClick:l[0]||(l[0]=o=>n.$router.back())},{default:a(()=>[e(u,null,{default:a(()=>[e(k(Z))]),_:1}),l[10]||(l[10]=b(" Back ",-1))]),_:1})]),e(Y,{model:t,rules:x,ref_key:"recipeFormRef",ref:C,"label-width":"120px"},{default:a(()=>[e(V,{class:"form-section"},{header:a(()=>[...l[11]||(l[11]=[i("h2",null,"Basic Information",-1)])]),default:a(()=>[e(p,{label:"Recipe Title",prop:"title"},{default:a(()=>[e(c,{modelValue:t.title,"onUpdate:modelValue":l[1]||(l[1]=o=>t.title=o),placeholder:"Enter recipe title"},null,8,["modelValue"])]),_:1}),e(p,{label:"Description",prop:"description"},{default:a(()=>[e(c,{modelValue:t.description,"onUpdate:modelValue":l[2]||(l[2]=o=>t.description=o),type:"textarea",rows:3,placeholder:"Brief description of your recipe"},null,8,["modelValue"])]),_:1}),e(p,{label:"Category",prop:"category"},{default:a(()=>[e(I,{modelValue:t.category,"onUpdate:modelValue":l[3]||(l[3]=o=>t.category=o),placeholder:"Select category"},{default:a(()=>[e(r,{label:"Main Dishes",value:"main"}),e(r,{label:"Quick Meals",value:"quick"}),e(r,{label:"Soups",value:"soups"}),e(r,{label:"Baking",value:"baking"}),e(r,{label:"Desserts",value:"desserts"}),e(r,{label:"Vegetarian",value:"vegetarian"}),e(r,{label:"Meat Dishes",value:"meat"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"Cover Image",prop:"coverImage"},{default:a(()=>[e(j,{class:"cover-uploader","show-file-list":!1,"on-change":B,"auto-upload":!1,accept:"image/*"},{default:a(()=>[t.coverImage?(g(),y("img",{key:0,src:t.coverImage,class:"cover-preview"},null,8,ae)):(g(),ee(u,{key:1,class:"cover-uploader-icon"},{default:a(()=>[e(k(q))]),_:1}))]),_:1}),l[12]||(l[12]=i("p",{class:"upload-tip"},"Click to upload cover image (recommended: 800x600px)",-1))]),_:1})]),_:1}),e(V,{class:"form-section"},{header:a(()=>[...l[13]||(l[13]=[i("h2",null,"Recipe Details",-1)])]),default:a(()=>[e(H,{gutter:20},{default:a(()=>[e(S,{span:8},{default:a(()=>[e(p,{label:"Cooking Time",prop:"cookingTime"},{default:a(()=>[e(h,{modelValue:t.cookingTime,"onUpdate:modelValue":l[4]||(l[4]=o=>t.cookingTime=o),min:1,max:999},null,8,["modelValue"]),l[14]||(l[14]=i("span",{class:"unit"},"minutes",-1))]),_:1})]),_:1}),e(S,{span:8},{default:a(()=>[e(p,{label:"Servings",prop:"servings"},{default:a(()=>[e(h,{modelValue:t.servings,"onUpdate:modelValue":l[5]||(l[5]=o=>t.servings=o),min:1,max:50},null,8,["modelValue"]),l[15]||(l[15]=i("span",{class:"unit"},"people",-1))]),_:1})]),_:1}),e(S,{span:8},{default:a(()=>[e(p,{label:"Difficulty",prop:"difficulty"},{default:a(()=>[e(I,{modelValue:t.difficulty,"onUpdate:modelValue":l[6]||(l[6]=o=>t.difficulty=o)},{default:a(()=>[e(r,{label:"Easy",value:"EASY"}),e(r,{label:"Medium",value:"MEDIUM"}),e(r,{label:"Hard",value:"HARD"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{class:"form-section"},{header:a(()=>[i("div",oe,[l[17]||(l[17]=i("h2",null,"Ingredients",-1)),e(s,{type:"primary",size:"small",onClick:F},{default:a(()=>[e(u,null,{default:a(()=>[e(k(q))]),_:1}),l[16]||(l[16]=b(" Add Ingredient ",-1))]),_:1})])]),default:a(()=>[i("div",se,[(g(!0),y(E,null,M(t.ingredients,(o,m)=>(g(),y("div",{key:m,class:"ingredient-item"},[e(c,{modelValue:o.name,"onUpdate:modelValue":f=>o.name=f,placeholder:"Ingredient name",style:{width:"60%"}},null,8,["modelValue","onUpdate:modelValue"]),e(c,{modelValue:o.amount,"onUpdate:modelValue":f=>o.amount=f,placeholder:"Amount",style:{width:"30%"}},null,8,["modelValue","onUpdate:modelValue"]),e(s,{type:"danger",circle:"",onClick:f=>O(m)},{default:a(()=>[e(u,null,{default:a(()=>[e(k(P))]),_:1})]),_:1},8,["onClick"])]))),128))])]),_:1}),e(V,{class:"form-section"},{header:a(()=>[i("div",re,[l[19]||(l[19]=i("h2",null,"Cooking Steps",-1)),e(s,{type:"primary",size:"small",onClick:$},{default:a(()=>[e(u,null,{default:a(()=>[e(k(q))]),_:1}),l[18]||(l[18]=b(" Add Step ",-1))]),_:1})])]),default:a(()=>[i("div",ie,[(g(!0),y(E,null,M(t.steps,(o,m)=>(g(),y("div",{key:m,class:"step-item"},[i("div",ne,U(m+1),1),e(c,{modelValue:o.description,"onUpdate:modelValue":f=>o.description=f,type:"textarea",rows:2,placeholder:`Step ${m+1} description`},null,8,["modelValue","onUpdate:modelValue","placeholder"]),e(s,{type:"danger",circle:"",onClick:f=>J(m)},{default:a(()=>[e(u,null,{default:a(()=>[e(k(P))]),_:1})]),_:1},8,["onClick"])]))),128))])]),_:1}),e(V,{class:"form-section"},{header:a(()=>[...l[20]||(l[20]=[i("h2",null,"Additional Information",-1)])]),default:a(()=>[e(p,{label:"Cooking Tips"},{default:a(()=>[e(c,{modelValue:t.tips,"onUpdate:modelValue":l[7]||(l[7]=o=>t.tips=o),type:"textarea",rows:3,placeholder:"Share your cooking tips and tricks..."},null,8,["modelValue"])]),_:1}),e(p,{label:"Equipment Needed"},{default:a(()=>[e(I,{modelValue:t.equipment,"onUpdate:modelValue":l[8]||(l[8]=o=>t.equipment=o),multiple:"",filterable:"","allow-create":"",placeholder:"Select or add equipment",style:{width:"100%"}},{default:a(()=>[e(r,{label:"Oven",value:"oven"}),e(r,{label:"Stove",value:"stove"}),e(r,{label:"Microwave",value:"microwave"}),e(r,{label:"Blender",value:"blender"}),e(r,{label:"Mixer",value:"mixer"}),e(r,{label:"Pressure Cooker",value:"pressure-cooker"}),e(r,{label:"Air Fryer",value:"air-fryer"}),e(r,{label:"Slow Cooker",value:"slow-cooker"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),i("div",de,[e(s,{onClick:l[9]||(l[9]=o=>n.$router.back())},{default:a(()=>[...l[21]||(l[21]=[b("Cancel",-1)])]),_:1}),e(s,{type:"info",onClick:z},{default:a(()=>[...l[22]||(l[22]=[b("Save as Draft",-1)])]),_:1}),e(s,{type:"primary",onClick:L,loading:w.value},{default:a(()=>[b(U(_.value?"Update Recipe":"Publish Recipe"),1)]),_:1},8,["loading"])])]),_:1},8,["model"])])}}},fe=Q(ue,[["__scopeId","data-v-5f0f456f"]]);export{fe as default};
