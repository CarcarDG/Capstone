import{H as y,_ as q,r as w,s as z,l as G,v as H,x as j,c as r,b as l,I as b,d as s,w as o,f as k,t as c,g as u,z as K,E as g,u as Q,o as i,k as f,A as W,B as X,C as Y,D as x,G as B,J as Z,F as D,p as V}from"./index-BhSzniFR.js";import{r as ee}from"./recipe-mvCqemeP.js";const R={getUserCollections(d){return y.get(`/collections/user/${d}`)},addToCollection(d,m){return y.post("/collections",{userId:d,recipeId:m})},removeFromCollection(d,m){return y.delete(`/collections/user/${d}/recipe/${m}`)},checkCollection(d,m){return y.get(`/collections/user/${d}/recipe/${m}/check`)}},te={class:"recipe-detail-page"},se={class:"back-button"},le={key:0,class:"recipe-header"},oe=["src","alt"],ae={class:"recipe-header-info"},ne={class:"description"},ce={class:"recipe-meta"},ie={class:"recipe-stats"},re={class:"action-buttons"},ue={key:1,class:"recipe-content"},de={key:0,class:"ingredients-list"},pe={class:"amount"},ve={key:1},_e={key:0,class:"steps-list"},fe={class:"step-number"},me={class:"step-content"},ge={key:1},he={__name:"RecipeDetail",setup(d){const m=G(),S=Q(),I=w(!1),p=w(JSON.parse(localStorage.getItem("user")||"{}")),t=w({id:0,title:"",description:"",coverImage:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c",difficulty:"MEDIUM",cookingTime:0,servings:0,viewCount:0,likeCount:0,collectCount:0,ingredients:[],steps:[],tips:""}),C=w(!1),N=()=>{const n=localStorage.getItem("user");if(n)try{p.value=JSON.parse(n)}catch(e){console.error("Failed to parse user data",e),p.value={}}else p.value={}},T=async n=>{I.value=!0;try{const e=await ee.getRecipeById(n);let v=[],h=[];try{v=typeof e.ingredients=="string"?JSON.parse(e.ingredients).map(a=>({...a,checked:!1})):e.ingredients||[]}catch(a){console.error("Failed to parse ingredients:",a),v=[]}try{h=typeof e.steps=="string"?JSON.parse(e.steps):e.steps||[]}catch(a){console.error("Failed to parse steps:",a),h=[]}t.value={...e,ingredients:v,steps:h,coverImage:e.coverImage||"https://images.unsplash.com/photo-1546069901-ba9599a7e63c",viewCount:e.viewCount||0,likeCount:e.likeCount||0,collectCount:e.collectCount||0},N(),p.value.id&&M(n)}catch(e){console.error("Failed to fetch recipe:",e),g.error("Failed to load recipe")}finally{I.value=!1}},M=async n=>{try{const e=await R.checkCollection(p.value.id,n);C.value=e}catch(e){console.error("Failed to check collection status:",e)}};z(()=>{const n=m.params.id;n&&T(n)});const U=()=>{S.push("/recipes")},A=async()=>{t.value.likeCount++,g.success("Liked!")},J=async()=>{if(N(),!p.value.id){g.warning("Please login to save recipes");return}try{C.value?(await R.removeFromCollection(p.value.id,t.value.id),t.value.collectCount--,C.value=!1,g.success("Removed from collections")):(await R.addToCollection(p.value.id,t.value.id),t.value.collectCount++,C.value=!0,g.success("Saved to collections!"))}catch(n){console.error("Failed to update collection:",n),g.error("Failed to update collection")}},P=()=>{S.push({path:"/meal-planner",query:{addRecipe:t.value.id}})};return(n,e)=>{const v=k("el-button"),h=k("el-tag"),a=k("el-icon"),$=k("el-checkbox"),F=k("el-card"),E=j("loading");return H((i(),r("div",te,[l("div",se,[s(v,{onClick:U,icon:"ArrowLeft"},{default:o(()=>[...e[0]||(e[0]=[u("Back to Recipes",-1)])]),_:1})]),t.value.id?(i(),r("div",le,[l("img",{src:t.value.coverImage,alt:t.value.title,class:"recipe-cover"},null,8,oe),l("div",ae,[l("h1",null,c(t.value.title),1),l("p",ne,c(t.value.description),1),l("div",ce,[s(h,{type:"success"},{default:o(()=>[u(c(t.value.difficulty),1)]),_:1}),l("span",null,[s(a,null,{default:o(()=>[s(f(W))]),_:1}),u(" "+c(t.value.cookingTime)+" min",1)]),l("span",null,[s(a,null,{default:o(()=>[s(f(X))]),_:1}),u(" "+c(t.value.servings)+" servings",1)])]),l("div",ie,[l("span",null,[s(a,null,{default:o(()=>[s(f(Y))]),_:1}),u(" "+c(t.value.viewCount)+" views",1)]),l("span",null,[s(a,null,{default:o(()=>[s(f(x))]),_:1}),u(" "+c(t.value.likeCount)+" likes",1)]),l("span",null,[s(a,null,{default:o(()=>[s(f(B))]),_:1}),u(" "+c(t.value.collectCount)+" saved",1)])]),l("div",re,[s(v,{type:"primary",onClick:A},{default:o(()=>[s(a,null,{default:o(()=>[s(f(x))]),_:1}),e[1]||(e[1]=u(" Like ",-1))]),_:1}),s(v,{onClick:J},{default:o(()=>[s(a,null,{default:o(()=>[s(f(B))]),_:1}),e[2]||(e[2]=u(" Save ",-1))]),_:1}),s(v,{onClick:P},{default:o(()=>[s(a,null,{default:o(()=>[s(f(Z))]),_:1}),e[3]||(e[3]=u(" Add to Meal Plan ",-1))]),_:1})])])])):b("",!0),t.value.id?(i(),r("div",ue,[s(F,{class:"ingredients-card"},{header:o(()=>[...e[4]||(e[4]=[l("h2",null,"Ingredients",-1)])]),default:o(()=>[t.value.ingredients&&t.value.ingredients.length>0?(i(),r("ul",de,[(i(!0),r(D,null,V(t.value.ingredients,(_,L)=>(i(),r("li",{key:L},[s($,{modelValue:_.checked,"onUpdate:modelValue":O=>_.checked=O},null,8,["modelValue","onUpdate:modelValue"]),l("span",null,c(_.name),1),l("span",pe,c(_.amount),1)]))),128))])):(i(),r("p",ve,"No ingredients listed"))]),_:1}),s(F,{class:"steps-card"},{header:o(()=>[...e[5]||(e[5]=[l("h2",null,"Cooking Steps",-1)])]),default:o(()=>[t.value.steps&&t.value.steps.length>0?(i(),r("div",_e,[(i(!0),r(D,null,V(t.value.steps,_=>(i(),r("div",{key:_.step,class:"step-item"},[l("div",fe,c(_.step),1),l("div",me,[l("p",null,c(_.description),1)])]))),128))])):(i(),r("p",ge,"No cooking steps listed"))]),_:1}),t.value.tips?(i(),K(F,{key:0,class:"tips-card"},{header:o(()=>[...e[6]||(e[6]=[l("h2",null,"ðŸ’¡ Tips",-1)])]),default:o(()=>[l("p",null,c(t.value.tips),1)]),_:1})):b("",!0)])):b("",!0)])),[[E,I.value]])}}},ye=q(he,[["__scopeId","data-v-13e75f54"]]);export{ye as default};
