import{_ as le,i as se,r as f,a as I,C as te,c as E,d as a,w as l,f as u,o as V,b as s,g as d,k as c,N as oe,t as i,O as ne,v as L,P as J,Q as O,A as re,B as j,G as ie,s as ue,E as y}from"./index-BUVx7fbB.js";const de={class:"profile-page"},me={class:"profile-banner"},pe={class:"avatar-section"},ve={class:"profile-info"},fe={class:"username"},ce={class:"profile-actions"},we={key:1,class:"profile-details"},_e={class:"detail-item"},ge={class:"value"},ye={class:"detail-item"},be={class:"value"},Pe={class:"detail-item"},ke={class:"value"},Ce={class:"detail-item"},Ve={class:"value"},he={class:"detail-item"},Ne={class:"value"},Se={class:"stat-item"},Ae={class:"stat-info"},Ue={class:"stat-value"},$e={class:"stat-item"},Fe={class:"stat-info"},Ee={class:"stat-value"},Re={class:"stat-item"},Me={class:"stat-info"},xe={class:"stat-value"},Be={class:"stat-item"},De={class:"stat-info"},Te={class:"stat-value"},qe={class:"avatar-upload"},Ie=["src"],Le={__name:"Profile",setup(Je){var M,x,B,D;const _=se(),S=f(null),A=f(null),b=f(!1),U=f(!1),$=f(!1),P=f(!1),F=f(!1),k=f(""),R=f(null),o=f({username:((M=_.user)==null?void 0:M.username)||"john",nickname:((x=_.user)==null?void 0:x.nickname)||"John Doe",email:"john@example.com",phone:"1234567891",avatar:((B=_.user)==null?void 0:B.avatar)||"https://i.pravatar.cc/200?img=33",role:((D=_.user)==null?void 0:D.role)||"USER",bio:"Food enthusiast and home cook. Love sharing recipes!",createdAt:"2025-01-01T00:00:00"}),r=I({nickname:o.value.nickname,email:o.value.email,phone:o.value.phone,bio:o.value.bio}),m=I({currentPassword:"",newPassword:"",confirmPassword:""}),h=f({recipes:12,notes:8,likes:234,collections:45}),G={nickname:[{required:!0,message:"Please enter nickname",trigger:"blur"},{min:2,max:50,message:"Nickname must be 2-50 characters",trigger:"blur"}],email:[{required:!0,message:"Please enter email",trigger:"blur"},{type:"email",message:"Please enter valid email",trigger:"blur"}],phone:[{pattern:/^\d{10,}$/,message:"Please enter valid phone number",trigger:"blur"}]},z={currentPassword:[{required:!0,message:"Please enter current password",trigger:"blur"}],newPassword:[{required:!0,message:"Please enter new password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],confirmPassword:[{required:!0,message:"Please confirm password",trigger:"blur"},{validator:(n,e,N)=>{e!==m.newPassword?N(new Error("Passwords do not match")):N()},trigger:"blur"}]},Q=async()=>{S.value&&await S.value.validate(async n=>{if(n){U.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),o.value.nickname=r.nickname,o.value.email=r.email,o.value.phone=r.phone,o.value.bio=r.bio,_.user.nickname=r.nickname,localStorage.setItem("user",JSON.stringify(_.user)),y.success("Profile updated successfully!"),b.value=!1}catch{y.error("Failed to update profile")}finally{U.value=!1}}})},H=async()=>{A.value&&await A.value.validate(async n=>{if(n){$.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),y.success("Password changed successfully!"),m.currentPassword="",m.newPassword="",m.confirmPassword=""}catch{y.error("Failed to change password")}finally{$.value=!1}}})},K=n=>{R.value=n.raw,k.value=URL.createObjectURL(n.raw)},W=async()=>{if(!R.value){y.warning("Please select an image");return}F.value=!0;try{await new Promise(n=>setTimeout(n,1500)),o.value.avatar=k.value,_.user.avatar=k.value,localStorage.setItem("user",JSON.stringify(_.user)),y.success("Avatar updated successfully!"),P.value=!1}catch{y.error("Failed to upload avatar")}finally{F.value=!1}},X=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return te(()=>{}),(n,e)=>{const N=u("el-avatar"),p=u("el-icon"),v=u("el-button"),Y=u("el-tag"),C=u("el-card"),g=u("el-input"),w=u("el-form-item"),T=u("el-form"),q=u("el-col"),Z=u("el-row"),ee=u("el-upload"),ae=u("el-dialog");return V(),E("div",de,[a(C,{class:"profile-header"},{default:l(()=>[s("div",me,[s("div",pe,[a(N,{size:120,src:o.value.avatar},null,8,["src"]),a(v,{type:"primary",size:"small",onClick:e[0]||(e[0]=t=>P.value=!0)},{default:l(()=>[a(p,null,{default:l(()=>[a(c(oe))]),_:1}),e[16]||(e[16]=d(" Change Avatar ",-1))]),_:1})]),s("div",ve,[s("h1",null,i(o.value.nickname),1),s("p",fe,"@"+i(o.value.username),1),a(Y,{type:o.value.role==="ADMIN"?"danger":"primary"},{default:l(()=>[d(i(o.value.role),1)]),_:1},8,["type"])]),s("div",ce,[a(v,{type:"primary",onClick:e[1]||(e[1]=t=>b.value=!b.value)},{default:l(()=>[a(p,null,{default:l(()=>[a(c(ne))]),_:1}),d(" "+i(b.value?"Cancel":"Edit Profile"),1)]),_:1})])])]),_:1}),a(Z,{gutter:20},{default:l(()=>[a(q,{span:16},{default:l(()=>[a(C,{class:"info-card"},{header:l(()=>[...e[17]||(e[17]=[s("h2",null,"Profile Information",-1)])]),default:l(()=>[b.value?(V(),L(T,{key:0,model:r,rules:G,ref_key:"editFormRef",ref:S,"label-width":"120px"},{default:l(()=>[a(w,{label:"Nickname",prop:"nickname"},{default:l(()=>[a(g,{modelValue:r.nickname,"onUpdate:modelValue":e[2]||(e[2]=t=>r.nickname=t),placeholder:"Enter your nickname"},null,8,["modelValue"])]),_:1}),a(w,{label:"Email",prop:"email"},{default:l(()=>[a(g,{modelValue:r.email,"onUpdate:modelValue":e[3]||(e[3]=t=>r.email=t),type:"email",placeholder:"Enter your email"},null,8,["modelValue"])]),_:1}),a(w,{label:"Phone",prop:"phone"},{default:l(()=>[a(g,{modelValue:r.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>r.phone=t),placeholder:"Enter your phone number"},null,8,["modelValue"])]),_:1}),a(w,{label:"Bio"},{default:l(()=>[a(g,{modelValue:r.bio,"onUpdate:modelValue":e[5]||(e[5]=t=>r.bio=t),type:"textarea",rows:4,placeholder:"Tell us about yourself..."},null,8,["modelValue"])]),_:1}),a(w,null,{default:l(()=>[a(v,{type:"primary",onClick:Q,loading:U.value},{default:l(()=>[...e[18]||(e[18]=[d("Save Changes",-1)])]),_:1},8,["loading"]),a(v,{onClick:e[6]||(e[6]=t=>b.value=!1)},{default:l(()=>[...e[19]||(e[19]=[d("Cancel",-1)])]),_:1})]),_:1})]),_:1},8,["model"])):(V(),E("div",we,[s("div",_e,[e[20]||(e[20]=s("span",{class:"label"},"Nickname:",-1)),s("span",ge,i(o.value.nickname),1)]),s("div",ye,[e[21]||(e[21]=s("span",{class:"label"},"Email:",-1)),s("span",be,i(o.value.email||"Not set"),1)]),s("div",Pe,[e[22]||(e[22]=s("span",{class:"label"},"Phone:",-1)),s("span",ke,i(o.value.phone||"Not set"),1)]),s("div",Ce,[e[23]||(e[23]=s("span",{class:"label"},"Bio:",-1)),s("span",Ve,i(o.value.bio||"No bio yet"),1)]),s("div",he,[e[24]||(e[24]=s("span",{class:"label"},"Member Since:",-1)),s("span",Ne,i(X(o.value.createdAt)),1)])]))]),_:1}),a(C,{class:"password-card"},{header:l(()=>[...e[25]||(e[25]=[s("h2",null,"Change Password",-1)])]),default:l(()=>[a(T,{model:m,rules:z,ref_key:"passwordFormRef",ref:A,"label-width":"150px"},{default:l(()=>[a(w,{label:"Current Password",prop:"currentPassword"},{default:l(()=>[a(g,{modelValue:m.currentPassword,"onUpdate:modelValue":e[7]||(e[7]=t=>m.currentPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(w,{label:"New Password",prop:"newPassword"},{default:l(()=>[a(g,{modelValue:m.newPassword,"onUpdate:modelValue":e[8]||(e[8]=t=>m.newPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(w,{label:"Confirm Password",prop:"confirmPassword"},{default:l(()=>[a(g,{modelValue:m.confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=t=>m.confirmPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(w,null,{default:l(()=>[a(v,{type:"primary",onClick:H,loading:$.value},{default:l(()=>[...e[26]||(e[26]=[d(" Change Password ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),a(q,{span:8},{default:l(()=>[a(C,{class:"stats-card"},{header:l(()=>[...e[27]||(e[27]=[s("h2",null,"My Statistics",-1)])]),default:l(()=>[s("div",Se,[a(p,null,{default:l(()=>[a(c(J))]),_:1}),s("div",Ae,[s("div",Ue,i(h.value.recipes),1),e[28]||(e[28]=s("div",{class:"stat-label"},"Recipes",-1))])]),s("div",$e,[a(p,null,{default:l(()=>[a(c(O))]),_:1}),s("div",Fe,[s("div",Ee,i(h.value.notes),1),e[29]||(e[29]=s("div",{class:"stat-label"},"Food Notes",-1))])]),s("div",Re,[a(p,null,{default:l(()=>[a(c(re))]),_:1}),s("div",Me,[s("div",xe,i(h.value.likes),1),e[30]||(e[30]=s("div",{class:"stat-label"},"Likes Received",-1))])]),s("div",Be,[a(p,null,{default:l(()=>[a(c(j))]),_:1}),s("div",De,[s("div",Te,i(h.value.collections),1),e[31]||(e[31]=s("div",{class:"stat-label"},"Collections",-1))])])]),_:1}),a(C,{class:"actions-card"},{header:l(()=>[...e[32]||(e[32]=[s("h2",null,"Quick Actions",-1)])]),default:l(()=>[a(v,{type:"primary",plain:"",block:"",onClick:e[10]||(e[10]=t=>n.$router.push("/recipes"))},{default:l(()=>[a(p,null,{default:l(()=>[a(c(J))]),_:1}),e[33]||(e[33]=d(" My Recipes ",-1))]),_:1}),a(v,{type:"success",plain:"",block:"",onClick:e[11]||(e[11]=t=>n.$router.push("/notes"))},{default:l(()=>[a(p,null,{default:l(()=>[a(c(O))]),_:1}),e[34]||(e[34]=d(" My Notes ",-1))]),_:1}),a(v,{type:"warning",plain:"",block:"",onClick:e[12]||(e[12]=t=>n.$router.push("/collections"))},{default:l(()=>[a(p,null,{default:l(()=>[a(c(j))]),_:1}),e[35]||(e[35]=d(" My Collections ",-1))]),_:1}),a(v,{type:"info",plain:"",block:"",onClick:e[13]||(e[13]=t=>n.$router.push("/meal-planner"))},{default:l(()=>[a(p,null,{default:l(()=>[a(c(ie))]),_:1}),e[36]||(e[36]=d(" Meal Planner ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),a(ae,{modelValue:P.value,"onUpdate:modelValue":e[15]||(e[15]=t=>P.value=t),title:"Change Avatar",width:"400px"},{footer:l(()=>[a(v,{onClick:e[14]||(e[14]=t=>P.value=!1)},{default:l(()=>[...e[38]||(e[38]=[d("Cancel",-1)])]),_:1}),a(v,{type:"primary",onClick:W,loading:F.value},{default:l(()=>[...e[39]||(e[39]=[d("Upload",-1)])]),_:1},8,["loading"])]),default:l(()=>[s("div",qe,[a(ee,{class:"avatar-uploader","show-file-list":!1,"on-change":K,"auto-upload":!1,accept:"image/*"},{default:l(()=>[k.value?(V(),E("img",{key:0,src:k.value,class:"avatar-preview"},null,8,Ie)):(V(),L(p,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[a(c(ue))]),_:1}))]),_:1}),e[37]||(e[37]=s("p",{class:"upload-tip"},"Click to upload a new avatar (JPG, PNG)",-1))])]),_:1},8,["modelValue"])])}}},je=le(Le,[["__scopeId","data-v-56e2655b"]]);export{je as default};
